import{W as I,r as n,c as S,j as e}from"./app-BCeIbwbS.js";import{I as F}from"./InputLabel-Dh1n7p9x.js";import{T as c}from"./TextInput-C0SWMqCi.js";import{I as h}from"./InputError-Du_QPRDL.js";import{S as d}from"./SecondaryButton-fKp8Hme2.js";import{P}from"./PrimaryButton-BWID-ifQ.js";import{_ as R}from"./index-BI_anNMO.js";import{I as y}from"./IconX-BXGqiD_u.js";import{I as D}from"./IconPlus-DacWi71H.js";import"./createReactComponent-0D3LNCDu.js";function z({project:x,maxFields:m,closeModal:u,auth:E}){const{data:a,setData:l,post:j,processing:f,errors:g,reset:b}=I({name:"",fields:[{name:"name",category:"fakerPHP",type:"person.firstName"},{name:"phone_number",category:"fakerPHP",type:"phoneNumber.phoneNumber"}]}),[i,v]=n.useState([]);n.useState(Array(a.fields.length).fill(!1)),n.useState([]),n.useEffect(()=>{S.get(route("resources.fields")).then(s=>{v(s.data.data)}).catch(s=>{console.error("There was an error!",s)})},[]);const k=s=>{s.preventDefault(),j(route("resources.store",{project:x}),{preserveScroll:!0,onSuccess:()=>{b(),u(),R.success("Resource created successfully")}})},p=s=>{if(typeof s=="string"){const r=s.split(" ");return r.splice(1,1),r.join(" ")}else return""},N=()=>{a.fields.length>=m||l("fields",[...a.fields,{name:"",category:"number",type:""}])},w=s=>{const r=a.fields;r.splice(s,1),l("fields",r)},C=s=>s.charAt(0).toUpperCase()+s.slice(1);return e.jsxs("form",{onSubmit:k,className:"p-6 overflow-y-scroll",style:{maxHeight:"100vh",overflowY:"auto"},children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:"Create Resource"}),e.jsxs("div",{className:"mt-6",children:[e.jsx(F,{htmlFor:"name-resource",value:"Resource Name"}),e.jsx(c,{id:"name-resource",type:"text",name:"name",required:!0,value:a.name,onChange:s=>l("name",s.target.value),className:"mt-1 block lg:w-2/4 md:w-2/4 sm:w-full",autoComplete:"off",placeholder:"Example: users, posts, comments"}),e.jsx(h,{message:g.name,className:"mt-2"})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mt-6",children:"Scheme"}),e.jsx("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-400",children:"Define Resource schema, it will be used to generate mock data."}),e.jsx("div",{children:e.jsxs("div",{className:"flex align-items-center mt-2",children:[e.jsx(c,{id:"field-name-id",disabled:!0,value:"id",autoComplete:"off",placeholder:"Field name",className:"w-3/12"}),e.jsx("select",{id:"category-type-id",className:" ml-6 w-3/12 border-gray-300 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 focus:border-indigo-500 dark:focus:border-indigo-600 focus:ring-indigo-500 dark:focus:ring-indigo-600 rounded-md shadow-sm",value:"Object ID",disabled:!0,children:e.jsx("option",{value:"number",children:"Unique ID"})})]})}),a.fields.map((s,r)=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex align-items-center mt-2",children:[e.jsx(c,{id:`field-name-${r}`,type:"text",required:!0,name:`fields[${r}][name]`,value:s.name,onChange:o=>{let t=[...a.fields];t[r].name=o.target.value,l("fields",t)},autoComplete:"off",placeholder:"Field name",className:"w-3/12"}),e.jsxs("select",{id:`category-type-${r}`,className:" ml-6 w-3/12 border-gray-300 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 focus:border-indigo-500 dark:focus:border-indigo-600 focus:ring-indigo-500 dark:focus:ring-indigo-600 rounded-md shadow-sm",value:s.category,onChange:o=>{let t=[...a.fields];t[r].category=o.target.value,l("fields",t)},children:[r==0&&e.jsx("option",{value:"number",children:"Unique ID"}),Object.entries(i).map(([o,t])=>e.jsx("option",{value:o,children:C(o)},o))]}),i[s.category]&&i[s.category].length>0&&e.jsx("select",{id:`field-type-${r}`,className:" ml-6 w-3/12 border-gray-300 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 focus:border-indigo-500 dark:focus:border-indigo-600 focus:ring-indigo-500 dark:focus:ring-indigo-600 rounded-md shadow-sm",value:s.type,onChange:o=>{let t=[...a.fields];t[r].type=o.target.value,l("fields",t),console.log(a.fields)},children:Object.entries(i[s.category]||{}).map(([o,t])=>e.jsx("option",{value:t,children:t},o))}),r!=0&&e.jsx(d,{type:"button",onClick:()=>w(r),className:"ml-6",children:e.jsx(y,{})}),r==0&&e.jsx(d,{style:{opacity:"0"},type:"button",onClick:()=>{},className:"ml-6",children:e.jsx(y,{})})]},r),e.jsx(h,{message:p(p(g[`fields.${r}.type`])),className:"mt-2"})]},r)),e.jsx(d,{className:"mt-6",type:"button",onClick:N,disabled:f||m<=a.fields.length,children:e.jsx(D,{size:25})})]}),e.jsxs("div",{className:"mt-6 flex justify-end",children:[e.jsx(d,{onClick:u,children:"Cancel"}),e.jsx(P,{className:"ms-3",disabled:f,children:"Submit"})]})]})}export{z as CreateResource};
