import{W as I,r as i,d as F,j as e}from"./app-5jPogs4x.js";import{I as S}from"./InputLabel-C1KnzeBG.js";import{T as c}from"./TextInput-D94DsnWb.js";import{I as y}from"./InputError-tdr2ADJM.js";import{S as d}from"./SecondaryButton-DFTKBi3h.js";import{P as E}from"./PrimaryButton-obzpOGb-.js";import{_ as R}from"./index-CMVvBdJP.js";import{I as h}from"./IconX-BqBLFPmt.js";import{I as D}from"./IconPlus-DUD2nx2q.js";import"./createReactComponent-BbZrUBLn.js";function H({project:x,maxFields:m,closeModal:u,auth:$}){const{data:o,setData:l,post:j,processing:f,errors:g,reset:b}=I({name:"",fields:[{name:"name",category:"person",type:"firstName"},{name:"phone_number",category:"phoneNumber",type:"phoneNumber"}]}),[n,v]=i.useState([]);i.useState(Array(o.fields.length).fill(!1)),i.useState([]),i.useEffect(()=>{F.get(route("resources.fields")).then(s=>{v(s.data.data)}).catch(s=>{console.error("There was an error!",s)})},[]);const N=s=>{s.preventDefault();let r=[...o.fields];r.forEach(t=>{t.type=t.type.replace(/,/g,"")}),l("fields",r),j(route("resources.store",{project:x}),{preserveScroll:!0,onSuccess:()=>{b(),u(),R.success("Resource created successfully")}})},p=s=>{if(typeof s=="string"){const r=s.split(" ");return r.splice(1,1),r.join(" ")}else return""},k=()=>{o.fields.length>=m||l("fields",[...o.fields,{name:"",category:"address",type:"city"}])},w=s=>{const r=o.fields;r.splice(s,1),l("fields",r)},C=s=>s.charAt(0).toUpperCase()+s.slice(1);return e.jsxs("form",{onSubmit:N,className:"p-6 overflow-y-scroll",style:{maxHeight:"100vh",overflowY:"auto"},children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:"Create Resource"}),e.jsxs("div",{className:"mt-6",children:[e.jsx(S,{htmlFor:"name-resource",value:"Resource Name"}),e.jsx(c,{id:"name-resource",type:"text",name:"name",required:!0,value:o.name,onChange:s=>l("name",s.target.value),className:"mt-1 block lg:w-2/4 md:w-2/4 sm:w-full",autoComplete:"off",placeholder:"Example: users, posts, comments"}),e.jsx(y,{message:g.name,className:"mt-2"})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mt-6",children:"Scheme"}),e.jsx("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-400",children:"Define Resource schema, it will be used to generate mock data."}),e.jsx("div",{children:e.jsxs("div",{className:"flex align-items-center mt-2",children:[e.jsx(c,{id:"field-name-id",disabled:!0,value:"id",autoComplete:"off",placeholder:"Field name",className:"w-3/12"}),e.jsx("select",{id:"category-type-id",className:" ml-6 w-3/12 border-gray-300 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 focus:border-indigo-500 dark:focus:border-indigo-600 focus:ring-indigo-500 dark:focus:ring-indigo-600 rounded-md shadow-sm",value:"Object ID",disabled:!0,children:e.jsx("option",{value:"number",children:"Unique ID"})})]})}),o.fields.map((s,r)=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex align-items-center mt-2",children:[e.jsx(c,{id:`field-name-${r}`,type:"text",required:!0,name:`fields[${r}][name]`,value:s.name,onChange:t=>{let a=[...o.fields];a[r].name=t.target.value,l("fields",a)},autoComplete:"off",placeholder:"Field name",className:"w-3/12"}),e.jsx("select",{id:`category-type-${r}`,className:" ml-6 w-3/12 border-gray-300 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 focus:border-indigo-500 dark:focus:border-indigo-600 focus:ring-indigo-500 dark:focus:ring-indigo-600 rounded-md shadow-sm",value:s.category,onChange:t=>{let a=[...o.fields];a[r].category=t.target.value,l("fields",a)},children:Object.entries(n).map(([t,a])=>e.jsx("option",{value:t,children:C(t)},t))}),n[s.category]&&e.jsx("select",{id:`field-type-${r}`,className:" ml-6 w-3/12 border-gray-300 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 focus:border-indigo-500 dark:focus:border-indigo-600 focus:ring-indigo-500 dark:focus:ring-indigo-600 rounded-md shadow-sm",value:s.type,onChange:t=>{let a=[...o.fields];a[r].type=t.target.value,l("fields",a)},children:Object.entries(n[s.category]||{}).map(([t,a])=>e.jsx("option",{value:a,children:a},t))}),r!=0&&e.jsx(d,{type:"button",onClick:()=>w(r),className:"ml-6",children:e.jsx(h,{})}),r==0&&e.jsx(d,{style:{opacity:"0"},type:"button",onClick:()=>{},className:"ml-6",children:e.jsx(h,{})})]},r),e.jsx(y,{message:p(p(g[`fields.${r}.type`])),className:"mt-2"})]},r)),e.jsx(d,{className:"mt-6",type:"button",onClick:k,disabled:f||m<=o.fields.length,children:e.jsx(D,{size:25})})]}),e.jsxs("div",{className:"mt-6 flex justify-end",children:[e.jsx(d,{onClick:u,children:"Cancel"}),e.jsx(E,{className:"ms-3",disabled:f,children:"Submit"})]})]})}export{H as CreateResource};
